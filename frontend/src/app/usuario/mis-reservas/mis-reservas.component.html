<div class="container mt-5">

  <h2 class="mb-4 text-center fw-bold">ðŸ“¦ Mis Reservas</h2>

  <!-- Cargando -->
  <div *ngIf="cargando" class="text-center text-secondary">
    Cargando reservas...
  </div>

  <!-- Error -->
  <div *ngIf="error" class="alert alert-danger text-center">
    {{ error }}
  </div>

  <!-- Sin reservas -->
  <div *ngIf="!cargando && reservas.length === 0" class="text-center text-muted mt-4">
    No tienes reservas todavÃ­a.
  </div>

  <!-- Lista de reservas -->
  <div *ngFor="let reserva of reservas" class="card mb-4 shadow-sm reserva-card">

    <div class="card-body d-flex flex-column flex-md-row align-items-center">

      <!-- Imagen del pack -->
      <img *ngIf="reserva.pack?.imagenUrl"
           [src]="'http://localhost:8080' + reserva.pack.imagenUrl"
           class="reserva-img rounded mb-3 mb-md-0 me-md-3">

      <div class="flex-grow-1">

        <h4 class="fw-bold mb-1">{{ reserva.pack?.titulo }}</h4>
        <p class="text-muted small mb-2">{{ reserva.pack?.descripcion }}</p>

        <p class="mb-1"><strong>Precio:</strong> {{ reserva.precioPagado ?? reserva.pack?.precio }} â‚¬</p>
        <p class="mb-1"><strong>Fecha reserva:</strong> {{ reserva.fechaReserva | date:'short' }}</p>

        <!-- Estado: adaptamos segÃºn tu backend -->
        <ng-container>
          <span class="badge bg-success" *ngIf="reserva.estado === 'RECOGIDA'">Recogido</span>
          <span class="badge bg-warning text-dark" *ngIf="reserva.estado === 'RESERVADA'">Pendiente de recoger</span>
          <span class="badge bg-danger" *ngIf="reserva.estado === 'CANCELADA'">Cancelada</span>
        </ng-container>

      </div>

      <!-- QR GENERADO: usamos angularx-qrcode -->
      <div class="text-center mt-3 mt-md-0">
        <!--
          Propiedades:
            - qrdata: valor que queremos codificar (tu codigoQr)
            - width: tamaÃ±o
            - errorCorrectionLevel: 'L'|'M'|'Q'|'H'
        -->
        <qrcode
          [qrdata]="reserva.codigoQr || reserva.codigoQr"
          [width]="150"
          [errorCorrectionLevel]="'M'">
        </qrcode>

        <p class="small text-muted mt-2">Muestra este QR al recoger</p>
      </div>

    </div>

  </div>

</div>
